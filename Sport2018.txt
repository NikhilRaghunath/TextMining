## Code for TEXT MINING of most appeared words in the world of football in 2018

install.packages(c("tm","wordcloud","RCurl","XML","SnowballC"))
library(tm)
library(wordcloud)
library('SnowballC')
library('RCurl')
source("C:/Users/Nikhil Bharadwaj/Documents/DIT Semester 1/Data Mining/htmlToText.R")
data1 <- htmlToText("https://www.express.co.uk/sport/football")
data2 <- htmlToText("https://www.skysports.com/football/news")
data3 <- htmlToText("https://www.goal.com/en-ie")
data4 <- htmlToText("https://www.mirror.co.uk/sport/football/news/")
data <- c(data1,data2,data3,data4)
# data <- c(data1, data2, data3, data4)
txt_corpus <- Corpus(VectorSource(data))
summary(txt_corpus)
tm_map <- tm_map (txt_corpus, stripWhitespace)
tm_map <- tm_map (tm_map, removePunctuation)
tm_map <- tm_map (tm_map, removeNumbers)
tm_map <- tm_map (tm_map, removeWords, stopwords("english"))
tm_map <- tm_map (tm_map, stemDocument)
tm_map <- tm_map (tm_map, removeWords, c("news", "good", "old", "new", "year","sport"))
inspect(tm_map)
Matrix <- TermDocumentMatrix(tm_map)
matrix_c <- as.matrix (Matrix)
freq <- sort (rowSums (matrix_c))
tmdata <- data.frame (words=names(freq), freq)
wordcloud (tmdata$words, tmdata$freq, max.words=2000, min.freq=3, scale=c(7,.5), random.order=FALSE, colors=brewer.pal(8, "Dark2"))